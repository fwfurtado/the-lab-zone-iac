import:
  - catalog/_truenas_app.yaml

components:
  terraform:
    caddy:
      metadata:
        terraform_workspace: "{{ .stack }}"
      vars:
        docker:
          image:
            registry: !env DOCKER_REGISTRY_ADDRESS
            repository: "custom/caddy"
            tag: "latest"
        cloudflare_api_key: !env CLOUDFLARE_API_KEY
        garage_endpoint: "10.40.1.10:3900"
        garage_bucket: "caddy-certs"
        garage_access_key: !env GARAGE_ACCESS_KEY
        garage_secret_key: !env GARAGE_SECRET_KEY
        gitea_ssh_backend: "10.40.1.20:22"
