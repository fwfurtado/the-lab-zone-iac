workflows:
  caddy/apply:
    description: "Apply the Caddy stack"
    steps:
      - type: shell
        command: >-
          caddy fmt --overwrite stacks/catalog/lxc/caddy/Caddyfile && echo "✅ Caddyfile was successfully formatted" || echo "❌ Caddyfile was not formatted"
      - type: shell
        command: >-
          sudo -E atmos packer build lxc -s caddy -- -force
      - command: terraform apply lxc -s caddy -auto-approve
